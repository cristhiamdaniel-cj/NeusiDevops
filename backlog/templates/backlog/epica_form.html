{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'backlog/epicas-form.css' %}?v=4">
{% endblock %}

{% block content %}
<h4 class="mb-3">
  {% if epica %}
    ‚úèÔ∏è Editar √âpica
  {% else %}
    ‚ûï Nueva √âpica
  {% endif %}
</h4>

<form method="post" novalidate>
  {% csrf_token %}

  {% if form.non_field_errors %}
    <div class="alert alert-danger mb-3">
      {% for e in form.non_field_errors %}
        {{ e }}<br>
      {% endfor %}
    </div>
  {% endif %}

  <div class="card shadow-sm">
    <div class="card-body">

      <!-- Proyecto con bot√≥n para crear uno nuevo -->
      <div class="mb-3">
        <label for="{{ form.proyecto.id_for_label }}" class="form-label">
          {{ form.proyecto.label }}
        </label>
        <div class="input-group">
          {{ form.proyecto }}
          <a href="{% url 'proyecto_create' %}"
             class="btn btn-outline-success"
             title="Crear nuevo proyecto">
            ‚ûï
          </a>
        </div>
        {% if form.proyecto.help_text %}
          <div class="form-text">{{ form.proyecto.help_text }}</div>
        {% endif %}
        {% for error in form.proyecto.errors %}
          <div class="text-danger small">{{ error }}</div>
        {% endfor %}
      </div>

      <!-- Campos restantes -->
      {% for field in form %}
        {% if field.name != "proyecto" %}
          <div class="mb-3">
            <label for="{{ field.id_for_label }}" class="form-label">
              {{ field.label }}
            </label>
            {{ field }}

            {% if field.help_text %}
              <div class="form-text">{{ field.help_text }}</div>
            {% endif %}

            {% for error in field.errors %}
              <div class="text-danger small">{{ error }}</div>
            {% endfor %}
          </div>
        {% endif %}
      {% endfor %}

    </div>
  </div>

  <div class="mt-3 d-flex gap-2">
    <button class="btn btn-primary" type="submit">üíæ Guardar</button>
    <a class="btn btn-outline-secondary" href="{% url 'epica_list' %}">Cancelar</a>
  </div>
</form>

{% endblock %}
